# Stencila Node.js

## 👋 Introduction

This is the `stencila` package for Node.js. It uses [`Neon`](https://neon-bindings.com/) to expose functionality implemented in the Stencila [Rust library](../rust) to Node.js. The main use of this package is to provide core functionality to the [Electron](https://www.electronjs.org/)-based [Stencila Desktop](../desktop) application.

## 📦 Install

```sh
npm install stencila
```

## 🚀 Use

```ts
import * as stencila from 'stencila'
```

See the in-code doc comment and the tests for more examples of usage. See the Neon docs for advice on using in [Electron apps](https://neon-bindings.com/docs/electron-apps).

## 🛠️ Develop

### Getting started

Given this package is a set of bindings to the Stencila [Rust library](../rust) you'll need to have [Rust installed](https://rustup.rs) to build it. Then, get started by cloning this repository, installing dependencies and building the package:

```sh
git clone git@github.com:stencila/stencila
cd stencila/node
make setup build
```

Please run formatting, linting and testing before contributing code e.g.

```sh
make format lint test
```

### Testing

There are tests in `src/*.test.ts` files. Note that most of these tests are aimed at picking up regressions in the API of this package, and not of the correctness of the wrapped Rust code for which tests exists in `../rust`.

### Project Layout

This project was bootstrapped by [create-neon](https://www.npmjs.com/package/create-neon). Its directory structure is something like:

```
node/
├── Cargo.toml
├── README.md
├── index.node
├── package.json
├── src/
|   └── lib.rs
|   └── index.ts
|   └── *.rs
|   └── *.ts
|   └── *.test.ts
```

The `index.node` file is a Node addon—i.e., a binary Node module—generated by building the project. Under the hood, a [Node addon](https://nodejs.org/api/addons.html) is a [dynamically-linked shared object](<https://en.wikipedia.org/wiki/Library_(computing)#Shared_libraries>). The `"build"` script produces this file by copying it from within the `../target/` directory, which is where the Rust build produces the shared object.

### Learn More

To learn more about Neon, see the [Neon documentation](https://neon-bindings.com).
To learn more about Rust, see the [Rust documentation](https://www.rust-lang.org).
To learn more about Node, see the [Node documentation](https://nodejs.org).
